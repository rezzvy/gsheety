class Gsheety{static parseURL(t){let e=t.match(/\/d\/([^/]+)/);if(!e)throw Error("Invalid Google Sheets URL");return`https://docs.google.com/spreadsheets/d/${e[1]}`}static async fetchJSON(t,e){let{sheet:s="Sheet1",query:a="SELECT *"}=e,r=await fetch(`${this.parseURL(t)}/gviz/tq?sheet=${encodeURIComponent(s)}&tq=${encodeURIComponent(a)}`);if(r.ok){let o=await r.text(),l=JSON.parse(o.slice(o.indexOf("{"),o.lastIndexOf("}")+1));return l.table?{data:l,msg:"ok"}:{data:null,msg:"Invalid query or empty response"}}return{data:null,msg:`HTTP Error ${r.status}: ${r.statusText}`}}static async get(t,e={}){if("object"!=typeof e)throw Error("Options parameter must be an object");let s=await this.fetchJSON(t,e);return s.data?e.raw?s:{cols:s.data.table.cols.map(t=>t?{label:t.label,type:t.type}:null).filter(t=>null!==t),rows:s.data.table.rows.map(t=>t.c.map(t=>t?t.v:null)).map(t=>t.filter(t=>null!==t)),msg:s.msg}:{cols:[],rows:[],msg:s.msg}}static async getExportedData(t,e="csv"){let s={csv:"export?format=csv",tsv:"export?format=tsv",pdf:"export?format=pdf",xlsx:"export?format=xlsx"};if(!s[e])throw Error("Unsupported format. Use: csv, tsv, pdf, or xlsx.");let a=await fetch(`${this.parseURL(t)}/${s[e]}`);if(!a.ok)throw Error(`HTTP Error ${a.status}: ${a.statusText}`);return"pdf"===e||"xlsx"===e?await a.blob():await a.text()}}"undefined"!=typeof module&&module.exports?module.exports=Gsheety:window.Gsheety=Gsheety;