class Gsheety{static parseURL(t){let e=t.match(/\/d\/([^/]+)/);if(!e)throw Error("Invalid Google Sheets URL");return`https://docs.google.com/spreadsheets/d/${e[1]}`}static async fetchJSON(t,e){let{sheet:a="Sheet1",query:s="SELECT *"}=e,l=await fetch(`${this.parseURL(t)}/gviz/tq?sheet=${encodeURIComponent(a)}&tq=${encodeURIComponent(s)}`);if(l.ok){let r=await l.text(),o=JSON.parse(r.slice(r.indexOf("{"),r.lastIndexOf("}")+1));return o.table?{data:o,msg:"ok"}:{data:null,msg:"Invalid query or empty response"}}return{data:null,msg:`HTTP Error ${l.status}: ${l.statusText}`}}static async get(t,e={}){if("object"!=typeof e)throw Error("Options parameter must be an object");let a=await this.fetchJSON(t,e);if(!a.data)return{cols:[],rows:[],msg:a.msg};if(e.raw)return a;let s=a.data.table.cols.map((t,e)=>({label:t?.label||`Column ${e+1}`,columnId:t?.id,type:t?.type})),l=a.data.table.rows.map(t=>s.map((e,a)=>{let s=t.c[a];return s?s.v:null}));return e.clearNull&&(l=l.map(t=>t.filter(t=>null!==t))),{cols:s,rows:l,msg:a.msg}}static async getExportedData(t,e="csv"){let a={csv:"export?format=csv",tsv:"export?format=tsv",pdf:"export?format=pdf",xlsx:"export?format=xlsx"};if(!a[e])throw Error("Unsupported format. Use: csv, tsv, pdf, or xlsx.");let s=await fetch(`${this.parseURL(t)}/${a[e]}`);if(!s.ok)throw Error(`HTTP Error ${s.status}: ${s.statusText}`);return"pdf"===e||"xlsx"===e?await s.blob():await s.text()}static generateTableFromOutput(t,e={}){if(!t||!Array.isArray(t.rows)||!Array.isArray(t.cols)||"ok"!==t.msg)throw Error("Given data parameter is not valid or available.");let a=document.createElement("table"),s=document.createElement("thead"),l=document.createElement("tbody");e.className?.table&&(a.className=e.className.table),e.className?.thead&&(s.className=e.className.thead),e.className?.tbody&&(l.className=e.className.tbody);let r=document.createElement("tr");return t.cols.forEach(t=>{let a=document.createElement("th");a.textContent=t.label,r.appendChild(a),"function"==typeof e.callback?.theadItem&&e.callback.theadItem(a)}),s.appendChild(r),t.rows.forEach(t=>{let a=document.createElement("tr");t.forEach(t=>{let s=document.createElement("td");s.textContent=t,a.appendChild(s),"function"==typeof e.callback?.tbodyItem&&e.callback.tbodyItem(s)}),l.appendChild(a)}),a.appendChild(s),a.appendChild(l),a}}"undefined"!=typeof module&&module.exports?module.exports=Gsheety:window.Gsheety=Gsheety;